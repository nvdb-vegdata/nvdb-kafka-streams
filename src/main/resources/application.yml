spring:
  application:
    name: kafka-at-home

  datasource:
    url: jdbc:sqlite:${SQLITE_DB_PATH:./data/kafka-at-home.db}
    driver-class-name: org.sqlite.JDBC
  sql:
    init:
      mode: always

  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
      acks: all
      retries: 3
    consumer:
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      group-id: kafka-at-home-consumer
      auto-offset-reset: earliest
    streams:
      bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
      application-id: kafka-at-home-streams
      properties:
        default.key.serde: org.apache.kafka.common.serialization.Serdes$StringSerde
        default.value.serde: org.apache.kafka.common.serialization.Serdes$StringSerde

# NVDB API Configuration
nvdb:
  api:
    base-url: ${NVDB_API_BASE_URL:https://nvdbapiles.atlas.vegvesen.no/uberiket/api/v1/}
  producer:
    enabled: ${NVDB_PRODUCER_ENABLED:false}
    backfill:
      batch-size: ${NVDB_BACKFILL_BATCH_SIZE:100}
    updates:
      batch-size: ${NVDB_UPDATES_BATCH_SIZE:100}
    schedule:
      type915: ${NVDB_SCHEDULE_TYPE915:60000}  # 1 minute
      type916: ${NVDB_SCHEDULE_TYPE916:60000}  # 1 minute
  enrichment:
    enabled: ${NVDB_ENRICHMENT_ENABLED:false}
    batch-size: ${NVDB_ENRICHMENT_BATCH_SIZE:1000}

# Kafka Topics Configuration
kafka:
  topics:
    input: nvdb-vegobjekter-raw
    output: nvdb-vegobjekter-transformed
    speedlimits: nvdb-fartsgrenser

# Logging Configuration
logging:
  level:
    root: INFO
    no.geirsagberg.kafkaathome: DEBUG
    org.apache.kafka: WARN
    org.springframework.kafka: INFO

# Server Configuration
server:
  port: ${SERVER_PORT:8080}

# Management/Actuator endpoints
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,kafka
  endpoint:
    health:
      show-details: always

# SpringDoc OpenAPI Configuration
springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
    operations-sorter: alpha
    tags-sorter: alpha
  info:
    title: NVDB Kafka Producer API
    description: REST API for managing NVDB data ingestion with backfill and updates modes
    version: 1.0.0
